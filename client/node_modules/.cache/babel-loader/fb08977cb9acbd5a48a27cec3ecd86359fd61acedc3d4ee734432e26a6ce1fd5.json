{"ast":null,"code":"import React,{Fragment,useContext,useEffect}from\"react\";import{useHistory}from\"react-router-dom\";import{LayoutContext}from\"../index\";import{cartListProduct}from\"./FetchApi\";import{isAuthenticate}from\"../auth/fetchApi\";import{cartList}from\"../productDetails/Mixins\";import{subTotal,quantity,totalCost}from\"./Mixins\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const apiURL=process.env.REACT_APP_API_URL;const CartModal=()=>{const history=useHistory();const{data,dispatch}=useContext(LayoutContext);const products=data.cartProduct;const cartModalOpen=()=>dispatch({type:\"cartModalToggle\",payload:!data.cartModal});useEffect(()=>{fetchData();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);const fetchData=async()=>{try{let responseData=await cartListProduct();if(responseData&&responseData.products){dispatch({type:\"cartProduct\",payload:responseData.products});dispatch({type:\"cartTotalCost\",payload:totalCost()});}}catch(error){console.log(error);}};const removeCartProduct=id=>{let cart=localStorage.getItem(\"cart\")?JSON.parse(localStorage.getItem(\"cart\")):[];if(cart.length!==0){cart=cart.filter(item=>item.id!==id);localStorage.setItem(\"cart\",JSON.stringify(cart));fetchData();dispatch({type:\"inCart\",payload:cartList()});dispatch({type:\"cartTotalCost\",payload:totalCost()});}if(cart.length===0){dispatch({type:\"cartProduct\",payload:null});fetchData();dispatch({type:\"inCart\",payload:cartList()});}};return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(!data.cartModal?\"hidden\":\"\",\" fixed top-0 z-30 w-full h-full bg-black opacity-50\")}),/*#__PURE__*/_jsx(\"section\",{className:\"\".concat(!data.cartModal?\"hidden\":\"\",\" fixed z-40 inset-0 flex items-start justify-end\"),children:/*#__PURE__*/_jsxs(\"div\",{style:{background:\"#303031\"},className:\"w-full md:w-5/12 lg:w-4/12 h-full flex flex-col justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border-b border-gray-700 flex justify-between\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-4 text-white text-lg font-semibold\",children:\"Cart\"}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 text-white\",children:/*#__PURE__*/_jsx(\"svg\",{onClick:e=>cartModalOpen(),className:\"w-6 h-6 cursor-pointer\",fill:\"currentColor\",viewBox:\"0 0 20 20\",xmlns:\"https://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\",clipRule:\"evenodd\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"m-4 flex-col\",children:[products&&products.length!==0&&products.map((item,index)=>{return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-white flex space-x-2 my-4 items-center\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"w-16 h-16 object-cover object-center\",src:\"\".concat(apiURL,\"/uploads/products/\").concat(item.pImages[0]),alt:\"cartProduct\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-full flex flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"my-2\",children:item.pName}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-400\",children:\"Quantity :\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-end\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-200\",children:quantity(item._id)})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-400\",children:\"Subtotoal :\"}),\" \",\"$\",subTotal(item._id,item.pPrice),\".00\"]}),\" \"]}),/*#__PURE__*/_jsx(\"div\",{onClick:e=>removeCartProduct(item._id),className:\"absolute top-0 right-0 text-white\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5 cursor-pointer\",fill:\"currentColor\",viewBox:\"0 0 20 20\",xmlns:\"https://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\",clipRule:\"evenodd\"})})})]})]})},index);}),products===null&&/*#__PURE__*/_jsx(\"div\",{className:\"m-4 flex-col text-white text-xl text-center\",children:\"No product in cart\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"m-4 space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{onClick:e=>cartModalOpen(),className:\"cursor-pointer px-4 py-2 border border-gray-400 text-white text-center cursor-pointer\",children:\"Continue shopping\"}),data.cartTotalCost?/*#__PURE__*/_jsx(Fragment,{children:isAuthenticate()?/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-2 bg-black text-white text-center cursor-pointer\",onClick:e=>{history.push(\"/checkout\");cartModalOpen();},children:[\"Checkout $\",data.cartTotalCost,\".00\"]}):/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-2 bg-black text-white text-center cursor-pointer\",onClick:e=>{history.push(\"/\");cartModalOpen();dispatch({type:\"loginSignupError\",payload:!data.loginSignupError});dispatch({type:\"loginSignupModalToggle\",payload:!data.loginSignupModal});},children:[\"Checkout $\",data.cartTotalCost,\".00\"]})}):/*#__PURE__*/_jsx(\"div\",{className:\"px-4 py-2 bg-black text-white text-center cursor-not-allowed\",children:\"Checkout\"})]})]})})]});};export default CartModal;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}