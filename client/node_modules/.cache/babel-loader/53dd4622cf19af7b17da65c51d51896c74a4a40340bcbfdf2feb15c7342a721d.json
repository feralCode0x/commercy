{"ast":null,"code":"import _objectSpread from\"/home/zetecoder/commercy/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{Fragment,useContext,useState,useEffect}from\"react\";import{ProductContext}from\"./index\";import{createProduct,getAllProduct}from\"./FetchApi\";import{getAllCategory}from\"../categories/FetchApi\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AddProductDetail=_ref=>{let{categories}=_ref;const{data,dispatch}=useContext(ProductContext);const alert=(msg,type)=>/*#__PURE__*/_jsx(\"div\",{className:\"bg-\".concat(type,\"-200 py-2 px-4 w-full\"),children:msg});const[fData,setFdata]=useState({pName:\"\",pDescription:\"\",pStatus:\"Active\",pImage:null,// Initial value will be null or empty array\npCategory:\"\",pPrice:\"\",pOffer:0,pQuantity:\"\",success:false,error:false});const fetchData=async()=>{let responseData=await getAllProduct();if(responseData&&responseData.Products){dispatch({type:\"fetchProductsAndChangeState\",payload:responseData.Products});}};const submitForm=async e=>{dispatch({type:\"loading\",payload:true});e.preventDefault();e.target.reset();if(!fData.pImage){dispatch({type:\"loading\",payload:false});return setFdata(_objectSpread(_objectSpread({},fData),{},{error:\"Please upload a category image\"}));}try{let responseData=await createProduct(fData);if(responseData.success){fetchData();setFdata(_objectSpread(_objectSpread({},fData),{},{pName:\"\",pDescription:\"\",pImage:\"\",pStatus:\"Active\",pCategory:\"\",pPrice:\"\",pQuantity:\"\",pOffer:0,success:responseData.success,error:false}));dispatch({type:\"loading\",payload:false});setTimeout(()=>{setFdata(_objectSpread(_objectSpread({},fData),{},{pName:\"\",pDescription:\"\",pImage:\"\",pStatus:\"Active\",pCategory:\"\",pPrice:\"\",pQuantity:\"\",pOffer:0,success:false,error:false}));},2000);}else if(responseData.error){setFdata(_objectSpread(_objectSpread({},fData),{},{success:false,error:responseData.error}));dispatch({type:\"loading\",payload:false});setTimeout(()=>{return setFdata(_objectSpread(_objectSpread({},fData),{},{error:false,success:false}));},2000);}}catch(error){console.log(error);}};return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{onClick:e=>dispatch({type:\"addProductModal\",payload:false}),className:\"\".concat(data.addProductModal?\"\":\"hidden\",\" fixed top-0 left-0 z-30 w-full h-full bg-black opacity-50\")}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(data.addProductModal?\"\":\"hidden\",\" fixed inset-0 flex items-center z-30 justify-center\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"mt-32 md:mt-0 relative bg-white w-11/12 md:w-3/6 shadow-lg flex flex-col items-center space-y-4 px-4 py-4 md:px-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between w-full pt-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-left font-semibold text-2xl tracking-wider\",children:\"Add Product\"}),/*#__PURE__*/_jsx(\"span\",{style:{background:\"#303031\"},onClick:e=>dispatch({type:\"addProductModal\",payload:false}),className:\"cursor-pointer text-gray-100 py-2 px-2 rounded-full\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",xmlns:\"https://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})})})]}),fData.error?alert(fData.error,\"red\"):\"\",fData.success?alert(fData.success,\"green\"):\"\",/*#__PURE__*/_jsxs(\"form\",{className:\"w-full\",onSubmit:e=>submitForm(e),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1 py-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/2 flex flex-col space-y-1 space-x-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"name\",children:\"Product Name *\"}),/*#__PURE__*/_jsx(\"input\",{onChange:e=>setFdata(_objectSpread(_objectSpread({},fData),{},{error:false,success:false,pName:e.target.value})),value:fData.pName,className:\"px-4 py-2 border focus:outline-none\",type:\"text\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/2 flex flex-col space-y-1 space-x-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"price\",children:\"Product Price *\"}),/*#__PURE__*/_jsx(\"input\",{onChange:e=>setFdata(_objectSpread(_objectSpread({},fData),{},{error:false,success:false,pPrice:e.target.value})),value:fData.pPrice,type:\"number\",className:\"px-4 py-2 border focus:outline-none\",id:\"price\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col space-y-2\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"description\",children:\"Product Description *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:fData.pDescription,onChange:e=>setFdata(_objectSpread(_objectSpread({},fData),{},{error:false,success:false,pDescription:e.target.value})),className:\"px-4 py-2 border focus:outline-none\",name:\"description\",id:\"description\",cols:5,rows:2})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col mt-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"image\",children:\"Product Images *\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 text-xs\",children:\"Must need 2 images\"}),/*#__PURE__*/_jsx(\"input\",{onChange:e=>setFdata(_objectSpread(_objectSpread({},fData),{},{error:false,success:false,pImage:[...e.target.files]})),value:fData.pImages,type:\"file\",accept:\".jpg, .jpeg, .png\",className:\"px-4 py-2 border focus:outline-none\",id:\"image\",multiple:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1 py-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/2 flex flex-col space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"status\",children:\"Product Status *\"}),/*#__PURE__*/_jsxs(\"select\",{onChange:e=>setFdata(_objectSpread(_objectSpread({},fData),{},{error:false,success:false,pStatus:e.target.value})),value:fData.pStatus,name:\"status\",className:\"px-4 py-2 border focus:outline-none\",id:\"status\",children:[/*#__PURE__*/_jsx(\"option\",{name:\"status\",value:\"Active\",children:\"Active\"}),/*#__PURE__*/_jsx(\"option\",{name:\"status\",value:\"Disabled\",children:\"Disabled\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/2 flex flex-col space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"status\",children:\"Product Category *\"}),/*#__PURE__*/_jsxs(\"select\",{onChange:e=>setFdata(_objectSpread(_objectSpread({},fData),{},{error:false,success:false,pCategory:e.target.value})),value:fData.pCategory,name:\"status\",className:\"px-4 py-2 border focus:outline-none\",id:\"status\",children:[/*#__PURE__*/_jsx(\"option\",{disabled:true,value:\"\",children:\"Select a category\"}),categories.length>0?categories.map(function(elem){return/*#__PURE__*/_jsx(\"option\",{name:\"status\",value:elem._id,children:elem.cName},elem._id);}):\"\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1 py-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/2 flex flex-col space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"quantity\",children:\"Product in Stock *\"}),/*#__PURE__*/_jsx(\"input\",{value:fData.pQuantity,onChange:e=>setFdata(_objectSpread(_objectSpread({},fData),{},{error:false,success:false,pQuantity:e.target.value})),type:\"number\",className:\"px-4 py-2 border focus:outline-none\",id:\"quantity\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/2 flex flex-col space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"offer\",children:\"Product Offfer (%) *\"}),/*#__PURE__*/_jsx(\"input\",{value:fData.pOffer,onChange:e=>setFdata(_objectSpread(_objectSpread({},fData),{},{error:false,success:false,pOffer:e.target.value})),type:\"number\",className:\"px-4 py-2 border focus:outline-none\",id:\"offer\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col space-y-1 w-full pb-4 md:pb-6 mt-4\",children:/*#__PURE__*/_jsx(\"button\",{style:{background:\"#303031\"},type:\"submit\",className:\"rounded-full bg-gray-800 text-gray-100 text-lg font-medium py-2\",children:\"Create product\"})})]})]})})]});};const AddProductModal=props=>{useEffect(()=>{fetchCategoryData();},[]);const[allCat,setAllCat]=useState({});const fetchCategoryData=async()=>{let responseData=await getAllCategory();if(responseData.Categories){setAllCat(responseData.Categories);}};return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(AddProductDetail,{categories:allCat})});};export default AddProductModal;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}