{"ast":null,"code":"import _objectSpread from\"/home/zetecoder/commercy/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{Fragment,useContext,useState,useEffect}from\"react\";import{ProductContext}from\"./index\";import{editProduct,getAllProduct}from\"./FetchApi\";import{getAllCategory}from\"../categories/FetchApi\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const apiURL=process.env.REACT_APP_API_URL;const EditProductModal=props=>{const{data,dispatch}=useContext(ProductContext);const[categories,setCategories]=useState(null);const alert=(msg,type)=>/*#__PURE__*/_jsx(\"div\",{className:\"bg-\".concat(type,\"-200 py-2 px-4 w-full\"),children:msg});const[editformData,setEditformdata]=useState({pId:\"\",pName:\"\",pDescription:\"\",pImages:null,pEditImages:null,pStatus:\"\",pCategory:\"\",pQuantity:\"\",pPrice:\"\",pOffer:\"\",error:false,success:false});useEffect(()=>{fetchCategoryData();},[]);const fetchCategoryData=async()=>{let responseData=await getAllCategory();if(responseData.Categories){setCategories(responseData.Categories);}};useEffect(()=>{setEditformdata({pId:data.editProductModal.pId,pName:data.editProductModal.pName,pDescription:data.editProductModal.pDescription,pImages:data.editProductModal.pImages,pStatus:data.editProductModal.pStatus,pCategory:data.editProductModal.pCategory,pQuantity:data.editProductModal.pQuantity,pPrice:data.editProductModal.pPrice,pOffer:data.editProductModal.pOffer});},[data.editProductModal]);const fetchData=async()=>{let responseData=await getAllProduct();if(responseData&&responseData.Products){dispatch({type:\"fetchProductsAndChangeState\",payload:responseData.Products});}};const submitForm=async e=>{e.preventDefault();if(!editformData.pEditImages){console.log(\"Image Not upload=============\",editformData);}else{console.log(\"Image uploading\");}try{let responseData=await editProduct(editformData);if(responseData.success){fetchData();setEditformdata(_objectSpread(_objectSpread({},editformData),{},{success:responseData.success}));setTimeout(()=>{return setEditformdata(_objectSpread(_objectSpread({},editformData),{},{success:responseData.success}));},2000);}else if(responseData.error){setEditformdata(_objectSpread(_objectSpread({},editformData),{},{error:responseData.error}));setTimeout(()=>{return setEditformdata(_objectSpread(_objectSpread({},editformData),{},{error:responseData.error}));},2000);}}catch(error){console.log(error);}};return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{onClick:e=>dispatch({type:\"editProductModalClose\",payload:false}),className:\"\".concat(data.editProductModal.modal?\"\":\"hidden\",\" fixed top-0 left-0 z-30 w-full h-full bg-black opacity-50\")}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(data.editProductModal.modal?\"\":\"hidden\",\" fixed inset-0 flex items-center z-30 justify-center overflow-auto\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"mt-32 md:mt-0 relative bg-white w-11/12 md:w-3/6 shadow-lg flex flex-col items-center space-y-4 px-4 py-4 md:px-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between w-full pt-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-left font-semibold text-2xl tracking-wider\",children:\"Edit Product\"}),/*#__PURE__*/_jsx(\"span\",{style:{background:\"#303031\"},onClick:e=>dispatch({type:\"editProductModalClose\",payload:false}),className:\"cursor-pointer text-gray-100 py-2 px-2 rounded-full\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",xmlns:\"https://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})})})]}),editformData.error?alert(editformData.error,\"red\"):\"\",editformData.success?alert(editformData.success,\"green\"):\"\",/*#__PURE__*/_jsxs(\"form\",{className:\"w-full\",onSubmit:e=>submitForm(e),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1 py-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/2 flex flex-col space-y-1 space-x-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"name\",children:\"Product Name *\"}),/*#__PURE__*/_jsx(\"input\",{value:editformData.pName,onChange:e=>setEditformdata(_objectSpread(_objectSpread({},editformData),{},{error:false,success:false,pName:e.target.value})),className:\"px-4 py-2 border focus:outline-none\",type:\"text\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/2 flex flex-col space-y-1 space-x-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"price\",children:\"Product Price *\"}),/*#__PURE__*/_jsx(\"input\",{value:editformData.pPrice,onChange:e=>setEditformdata(_objectSpread(_objectSpread({},editformData),{},{error:false,success:false,pPrice:e.target.value})),type:\"number\",className:\"px-4 py-2 border focus:outline-none\",id:\"price\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col space-y-2\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"description\",children:\"Product Description *\"}),/*#__PURE__*/_jsx(\"textarea\",{value:editformData.pDescription,onChange:e=>setEditformdata(_objectSpread(_objectSpread({},editformData),{},{error:false,success:false,pDescription:e.target.value})),className:\"px-4 py-2 border focus:outline-none\",name:\"description\",id:\"description\",cols:5,rows:2})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col mt-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"image\",children:\"Product Images *\"}),editformData.pImages?/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"h-16 w-16 object-cover\",src:\"\".concat(apiURL,\"/uploads/products/\").concat(editformData.pImages[0]),alt:\"productImage\"}),/*#__PURE__*/_jsx(\"img\",{className:\"h-16 w-16 object-cover\",src:\"\".concat(apiURL,\"/uploads/products/\").concat(editformData.pImages[1]),alt:\"productImage\"})]}):\"\",/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600 text-xs\",children:\"Must need 2 images\"}),/*#__PURE__*/_jsx(\"input\",{onChange:e=>setEditformdata(_objectSpread(_objectSpread({},editformData),{},{error:false,success:false,pEditImages:[...e.target.files]})),type:\"file\",accept:\".jpg, .jpeg, .png\",className:\"px-4 py-2 border focus:outline-none\",id:\"image\",multiple:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1 py-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/2 flex flex-col space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"status\",children:\"Product Status *\"}),/*#__PURE__*/_jsxs(\"select\",{value:editformData.pStatus,onChange:e=>setEditformdata(_objectSpread(_objectSpread({},editformData),{},{error:false,success:false,pStatus:e.target.value})),name:\"status\",className:\"px-4 py-2 border focus:outline-none\",id:\"status\",children:[/*#__PURE__*/_jsx(\"option\",{name:\"status\",value:\"Active\",children:\"Active\"}),/*#__PURE__*/_jsx(\"option\",{name:\"status\",value:\"Disabled\",children:\"Disabled\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/2 flex flex-col space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"status\",children:\"Product Category *\"}),/*#__PURE__*/_jsxs(\"select\",{onChange:e=>setEditformdata(_objectSpread(_objectSpread({},editformData),{},{error:false,success:false,pCategory:e.target.value})),name:\"status\",className:\"px-4 py-2 border focus:outline-none\",id:\"status\",children:[/*#__PURE__*/_jsx(\"option\",{disabled:true,value:\"\",children:\"Select a category\"}),categories&&categories.length>0?categories.map(elem=>{return/*#__PURE__*/_jsx(Fragment,{children:editformData.pCategory._id&&editformData.pCategory._id===elem._id?/*#__PURE__*/_jsx(\"option\",{name:\"status\",value:elem._id,selected:true,children:elem.cName},elem._id):/*#__PURE__*/_jsx(\"option\",{name:\"status\",value:elem._id,children:elem.cName},elem._id)},elem._id);}):\"\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1 py-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/2 flex flex-col space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"quantity\",children:\"Product in Stock *\"}),/*#__PURE__*/_jsx(\"input\",{value:editformData.pQuantity,onChange:e=>setEditformdata(_objectSpread(_objectSpread({},editformData),{},{error:false,success:false,pQuantity:e.target.value})),type:\"number\",className:\"px-4 py-2 border focus:outline-none\",id:\"quantity\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-1/2 flex flex-col space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"offer\",children:\"Product Offfer (%) *\"}),/*#__PURE__*/_jsx(\"input\",{value:editformData.pOffer,onChange:e=>setEditformdata(_objectSpread(_objectSpread({},editformData),{},{error:false,success:false,pOffer:e.target.value})),type:\"number\",className:\"px-4 py-2 border focus:outline-none\",id:\"offer\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col space-y-1 w-full pb-4 md:pb-6 mt-4\",children:/*#__PURE__*/_jsx(\"button\",{style:{background:\"#303031\"},type:\"submit\",className:\"rounded-full bg-gray-800 text-gray-100 text-lg font-medium py-2\",children:\"Update product\"})})]})]})})]});};export default EditProductModal;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}